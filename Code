contacts = {}  # додано відсутнє оголошення словника

#decorator
def input_error(func):
    def inner(*args):
        try:
            result = func(*args)
            return result
        except KeyError:
            return "Contact not found"
        except ValueError:
            return "Please give me name and phone number separated by space"
        except IndexError:
            return "Please provide name or name and phone number separated by space"
    return inner



def hello_users(_):
    print("How can I help you?")

@error_handler
def add_contact(args):  
    name, phone = args  # розбиваємо аргумент на name та phone
    contacts[name] = phone
    return f"{name}'s phone number {phone} added"

def unknown_command(_):
    print('Unknown command') 

@error_handler
def change_contact(name, phone):
    old_phone = contacts[name]
    contacts[name] = phone
    return f"{name}'s old phone number {old_phone} changed to {phone}"

def show_all(_):
    if not contacts:
        return "No contacts found"
    for name, phone in contacts.items():
        result += f'Name {name}: phone {phone} \n'
    return result


HANDLERS {
    'hello': hello_users,
    'add': add_contact,
    'change': change_contact,
    'show all': show_all
}


def parse_input(user_input):
    command, *args = user_input.split()
    command = command.lstrip()


    try:
        handler =   HANDLERS[command.lower()]
    except KeyError:
        if args:
            command = command + ' ' + args[0]
            args = args[1:]
        handler = HANDLERS.get(command.lower(), unknown_command)
    return handler, args


def main():
    while True:
        user_input = input('Please, imput command and args. For example: add Lesia 033-332-2233')
        handler, *args = parse_input(user_input)
        result = handler(*args)
        if not result:
            print('inpout true args')
            break
        print(result)

if __name__ == "__main__":
    main()
